---
import { app } from "@lib/firebase/server";
import { getAuth } from "firebase-admin/auth";
import Layout from "@layouts/Layout.astro";
import { getFirestore } from "firebase-admin/firestore";
import Back from '@components/Back.astro'


const auth = getAuth(app);
const db = getFirestore(app)

/* Check current session */
if (!Astro.cookies.has("session")) {
  return Astro.redirect("/signin");
}
const sessionCookie = Astro.cookies.get("session").value;
const decodedCookie = await auth.verifySessionCookie(sessionCookie);
const user = await auth.getUser(decodedCookie.uid);

if (!user) {
  return Astro.redirect("/signin");
}


const userRef = db.collection("users").doc(user.uid)
const userSnapshot = await userRef.get();
const userData = userSnapshot.data();

const {name, email, status, tariff, joined, expiresAt, telegramName} = userData


---

<Layout title="Essay">
<header class=" w-full sticky top-0 bg-gray-900 shadow-lg flex  items-center px-5 text-xl font-semibold text-gray-100">
<Back/> Back
</header>
<h1 class="text-center text-3xl text-gray-100 my-3 mt-8">IELTS Writing Task 2</h1>

<div class='box mt-8 flex items-start justify-center text-center'>
 <a data-astro-reload href='/essay/essay' class="box-child bg-gray-900 rounded-xl text-gray-50 py-2 px-5 mx-2 shadow-xl">✅ Essay Checker</a>
 <a data-astro-reload href="/essay/generate" class="box-child bg-gray-900 rounded-xl text-gray-50 shadow-xl py-2 px-5 mx-2">⚙️ Essay Generate</a>

</div>

</Layout>

<style>

@media screen and (max-width:660px){
  .box{
  flex-direction:column
  }
  .box-child{
  width:90%;
  margin: 8px 5%;
  }
}
</style>

---
import Layout from '../../../layouts/Layout.astro'
import AudioLoader from '../../../components/AudioLoader.astro';
import Speaking from '../../../components/Speaking.astro';
import Home from '../../../components/Home.astro'
import { app } from "@lib/firebase/server";
import { getAuth } from "firebase-admin/auth";
import { getFirestore } from "firebase-admin/firestore";


const auth = getAuth(app);
const db = getFirestore(app)

/* Check current session */
if (!Astro.cookies.has("session")) {
  return Astro.redirect("/signin");
}
const sessionCookie = Astro.cookies.get("session").value;
const decodedCookie = await auth.verifySessionCookie(sessionCookie);
const user = await auth.getUser(decodedCookie.uid);

if (!user) {
  return Astro.redirect("/signin");
}

const userRef = db.collection("users").doc(user.uid)
const userSnapshot = await userRef.get();
const userData = userSnapshot.data();

const {tariff, telegram, telegramName, status} = userData

if(status ==="unpaid" || status ===""){
  return Astro.redirect("/price");	
}

---

<Layout title="Speaking">
    <AudioLoader/>
	<Home/>
     <Speaking test="Test 18. Patience & Gift"/>

     <audio src="/mock-tests/test18/1.mp3" id="audio1"></audio>
     <audio src="/mock-tests/test18/2.mp3" id="audio2"></audio>
     <audio src="/mock-tests/test18/3.mp3" id="audio3"></audio>
     <audio src="/mock-tests/test18/4.mp3" id="audio4"></audio>
     <audio src="/mock-tests/test18/5.mp3" id="audio5"></audio>
     <audio src="/mock-tests/test18/6.mp3" id="audio6"></audio>
     <audio src="/mock-tests/test12/part2/intro.mp3" id="audio7"></audio>
     <audio src="/mock-tests/test18/part2/1.mp3" id="audio8"></audio>
	 <audio src="/mock-tests/test12/part3/intro.mp3" id="audio9"></audio>
	 <audio src="/mock-tests/test18/part3/1.mp3" id="audio10"></audio>
	 <audio src="/mock-tests/test18/part3/2.mp3" id="audio11"></audio>
	 <audio src="/mock-tests/test18/part3/3.mp3" id="audio12"></audio>
	 <audio src="/mock-tests/test18/part3/4.mp3" id="audio13"></audio>
	 <audio src="/mock-tests/test18/part3/5.mp3" id="audio14"></audio>
	 <audio src="/mock-tests/test12/part3/end.mp3" id="audio15"></audio>
                        
</Layout>

<script is:inline>

var q=[
     'Is it important to be patient?',
   'Is it easy to be patient?',
   'How can people be patient?',
   'When do people need to be patient?',
   'What do you do when waiting for the bus or something else?',
   'Are people now less patient than people in the past? Why?',
   '<p><b>Describe a time when you received money as a gift.</b></p><p>You should say:</p><ul><li>When did you receive it?</li><li>What did you do with it?</li><li>How did you feel about it?</li></ul><br><textarea class="form-control" id="exampleFormControlTextarea1" rows="3" placeholder="Izoh yozish uchun"></textarea>',
   'Why do we like free gifts?',
   'Why do restaurants and shopping centres give free gifts?',
   'Do freebies really turn into motivation for customers to revisit?',
   'Can the excess of free gifts have the negative impact too?',
   'What kind of things can be given as a gift?'
	]

</script>

<script src="../../../scripts/quiz.js"></script>  

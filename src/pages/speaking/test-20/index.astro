---
import Layout from '../../../layouts/Layout.astro'
import AudioLoader from '../../../components/AudioLoader.astro';
import Speaking from '../../../components/Speaking.astro';
import Home from '../../../components/Home.astro'
import { app } from "@lib/firebase/server";
import { getAuth } from "firebase-admin/auth";
import { getFirestore } from "firebase-admin/firestore";


const auth = getAuth(app);
const db = getFirestore(app)

/* Check current session */
if (!Astro.cookies.has("session")) {
  return Astro.redirect("/signin");
}
const sessionCookie = Astro.cookies.get("session").value;
const decodedCookie = await auth.verifySessionCookie(sessionCookie);
const user = await auth.getUser(decodedCookie.uid);

if (!user) {
  return Astro.redirect("/signin");
}

const userRef = db.collection("users").doc(user.uid)
const userSnapshot = await userRef.get();
const userData = userSnapshot.data();

const {tariff, telegram, telegramName, status} = userData

if(status ==="unpaid" || status ===""){
  return Astro.redirect("/price");	
}

---

<Layout title="Speaking">
    <AudioLoader/>
	<Home/>
     <Speaking test="Test 20. Birthday"/>

     <audio src="/mock-tests/test20/1.mp3" id="audio1"></audio>
     <audio src="/mock-tests/test20/2.mp3" id="audio2"></audio>
     <audio src="/mock-tests/test20/3.mp3" id="audio3"></audio>
     <audio src="/mock-tests/test20/4.mp3" id="audio4"></audio>
     <audio src="/mock-tests/test20/5.mp3" id="audio5"></audio>
     <audio src="/mock-tests/test20/6.mp3" id="audio6"></audio>
     <audio src="/mock-tests/test12/part2/intro.mp3" id="audio7"></audio>
     <audio src="/mock-tests/test20/part2/1.mp3" id="audio8"></audio>
     <audio src="/mock-tests/test12/part3/intro.mp3" id="audio9"></audio>
     <audio src="/mock-tests/test20/part3/1.mp3" id="audio10"></audio>
     <audio src="/mock-tests/test20/part3/2.mp3" id="audio11"></audio>
     <audio src="/mock-tests/test20/part3/3.mp3" id="audio12"></audio>
     <audio src="/mock-tests/test20/part3/4.mp3" id="audio13"></audio>
     <audio src="/mock-tests/test20/part3/5.mp3" id="audio14"></audio>
     <audio src="/mock-tests/test12/part3/end.mp3" id="audio15"></audio>
                        
</Layout>

<script is:inline>

var q= [
"What did you usually do on your birthday when you were a child?\n",
"How do you normally celebrate your birthday now?\n",
"Is your birthday now still as important to you as when you were a child?\n",
"Do you think it’s important to give someone a card when it’s their birthday?\n",
"Do you think the price of gifts/presents is important?\n",
"Whom did you give a present last time?",
"Talk about a birthday party you can remember well. You should say:<br>\n<ul>\n<li>How you celebrated</li>\n<li>Who you were with</li>\n<li>Why do you remember that day</li>\n<li> and say how it was different from other birthdays you have had before or since</li></ul>",
"Do people in your country spend a lot of money on celebrating birthdays?",
"Do you think it’s necessary to spend a lot of money on holding a party?\n",
"Do people in your country usually go out to celebrate traditional festivals with others?\n",
"What is the importance of traditional festivals?\n",
"What is the difference between festivals that are celebrated now and in the past?\n"
]

</script>

<script src="../../../scripts/quiz.js"></script>  
